"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7333],{44573:function(e,t,s){s.d(t,{AOx:function(){return eh},Ao0:function(){return eq},IGC:function(){return eg},JZE:function(){return ed},QR:function(){return ei},WDe:function(){return em},ZQL:function(){return eX},_y:function(){return ep},cx:function(){return Z},gQe:function(){return ej},i8b:function(){return ev},nNj:function(){return er},uS7:function(){return en},w9d:function(){return ey}});var r,n,i,o,a,l,d,u,h,c,p,m,g,f,y,v,S,x,k,E,b=s(57555),M=s(378),w=s(31857),O=s(27398),A=s(47650),P=s(61082),C=s(13017),T=s(48776),R=s(12806),N=s(2376),H=s(84133),_=s(25804),K=s(84348),D=s(36912),I=s(82696),L=s(69400),V=s(84799),B=s(48111),F=s(45298),U=Object.defineProperty,W=Object.getOwnPropertyDescriptor,G=(e,t,s,r)=>{for(var n,i=r>1?void 0:r?W(t,s):t,o=e.length-1;o>=0;o--)(n=e[o])&&(i=(r?n(t,s,i):n(i))||i);return r&&i&&U(t,s,i),i},j=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},$=(e,t,s)=>(j(e,t,"read from private field"),s?s.call(e):t.get(e)),q=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},X=(e,t,s,r)=>(j(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s);function J(e,t){return e===t}function z(e){let{previousOptions:t,update:s,equals:r=J}=e,n=(0,b.vV)({...t,...s}),i=(0,b.Ry)(),o=(0,b.XP)(t);for(let a of o){let l=t[a],d=n[a];if(r(l,d)){i[a]={changed:!1};continue}i[a]={changed:!0,previousValue:l,value:d}}let u=e=>{let t=(0,b.Ry)();for(let s of e){let r=i[s];(null==r?void 0:r.changed)&&(t[s]=r.value)}return t};return{changes:(0,b.vV)(i),options:n,pickChanged:u}}var Q={[M.mA.DUPLICATE_HELPER_NAMES]:"helper method",[M.mA.DUPLICATE_COMMAND_NAMES]:"command method"};function Y(e){let{name:t,set:s,code:r}=e,n=Q[r];(0,b.kG)(!s.has(t),{code:r,message:`There is a naming conflict for the name: ${t} used in this '${n}'. Please rename or remove from the editor to avoid runtime errors.`}),s.add(t)}function Z(...e){return(0,b.Nb)((0,P.cx)(...e).split(" ")).join(" ")}var ee="__IGNORE__",et=class{constructor(e,...[t]){this["~O"]={},this._mappedHandlers=(0,b.Ry)(),this.populateMappedHandlers(),this._options=this._initialOptions=(0,b.RH)(e,this.constructor.defaultOptions,t??(0,b.Ry)(),this.createDefaultHandlerOptions()),this._dynamicKeys=this.getDynamicKeys(),this.init()}get options(){return this._options}get dynamicKeys(){return this._dynamicKeys}get initialOptions(){return this._initialOptions}init(){}getDynamicKeys(){let e=[],{customHandlerKeys:t,handlerKeys:s,staticKeys:r}=this.constructor;for(let n of(0,b.XP)(this._options))r.includes(n)||s.includes(n)||t.includes(n)||e.push(n);return e}ensureAllKeysAreDynamic(e){if(O.NZ.isProduction)return;let t=[];for(let s of(0,b.XP)(e))this._dynamicKeys.includes(s)||t.push(s);(0,b.kG)((0,b.yD)(t),{code:M.mA.INVALID_SET_EXTENSION_OPTIONS,message:`Invalid properties passed into the 'setOptions()' method: ${JSON.stringify(t)}.`})}setOptions(e){var t;let s=this.getDynamicOptions();this.ensureAllKeysAreDynamic(e);let{changes:r,options:n,pickChanged:i}=z({previousOptions:s,update:e});this.updateDynamicOptions(n),null==(t=this.onSetOptions)||t.call(this,{reason:"set",changes:r,options:n,pickChanged:i,initialOptions:this._initialOptions})}resetOptions(){var e;let t=this.getDynamicOptions(),{changes:s,options:r,pickChanged:n}=z({previousOptions:t,update:this._initialOptions});this.updateDynamicOptions(r),null==(e=this.onSetOptions)||e.call(this,{reason:"reset",options:r,changes:s,pickChanged:n,initialOptions:this._initialOptions})}getDynamicOptions(){return A(this._options,[...this.constructor.customHandlerKeys,...this.constructor.handlerKeys])}updateDynamicOptions(e){this._options={...this._options,...e}}populateMappedHandlers(){for(let e of this.constructor.handlerKeys)this._mappedHandlers[e]=[]}createDefaultHandlerOptions(){let e=(0,b.Ry)();for(let t of this.constructor.handlerKeys)e[t]=(...e)=>{var s;let{handlerKeyOptions:r}=this.constructor,n=null==(s=r[t])?void 0:s.reducer,i=null==n?void 0:n.getDefault(...e);for(let[,o]of this._mappedHandlers[t]){let a=o(...e);if(function(e,t,s){let{__ALL__:r}=e,n=e[s];return(!!r||!!n)&&(!!n&&n.earlyReturnValue!==ee&&((0,b.mf)(n.earlyReturnValue)?!0===n.earlyReturnValue(t):t===n.earlyReturnValue)||!!r&&r.earlyReturnValue!==ee&&((0,b.mf)(r.earlyReturnValue)?!0===r.earlyReturnValue(t):t===r.earlyReturnValue))}(r,i=n?n.accumulator(i,a,...e):a,t))break}return i};return e}addHandler(e,t,s=M.xV.Default){return this._mappedHandlers[e].push([s,t]),this.sortHandlers(e),()=>this._mappedHandlers[e]=this._mappedHandlers[e].filter(([,e])=>e!==t)}hasHandlers(e){return(this._mappedHandlers[e]??[]).length>0}sortHandlers(e){this._mappedHandlers[e]=(0,b.DY)(this._mappedHandlers[e],([e],[t])=>t-e)}addCustomHandler(e,t){var s;return(null==(s=this.onAddCustomHandler)?void 0:s.call(this,{[e]:t}))??b.ZT}};et.defaultOptions={},et.staticKeys=[],et.handlerKeys=[],et.handlerKeyOptions={},et.customHandlerKeys=[];var es=class extends et{constructor(...e){for(let t of(super(eo,...e),this["~E"]={},this._extensions=(0,b.uw)(this.createExtensions(),e=>e.constructor),this.extensionMap=new Map,this._extensions))this.extensionMap.set(t.constructor,t)}get priority(){return this.priorityOverride??this.options.priority??this.constructor.defaultPriority}get constructorName(){return`${(0,w.Ho)(this.name)}Extension`}get store(){return(0,b.kG)(this._store,{code:M.mA.MANAGER_PHASE_ERROR,message:"An error occurred while attempting to access the 'extension.store' when the Manager has not yet set created the lifecycle methods."}),(0,b.vV)(this._store,{requireKeys:!0})}get extensions(){return this._extensions}replaceChildExtension(e,t){this.extensionMap.has(e)&&(this.extensionMap.set(e,t),this._extensions=this.extensions.map(s=>t.constructor===e?t:s))}createExtensions(){return[]}getExtension(e){let t=this.extensionMap.get(e);return(0,b.kG)(t,{code:M.mA.INVALID_GET_EXTENSION,message:`'${e.name}' does not exist within the preset: '${this.name}'`}),t}isOfType(e){return this.constructor===e}setStore(e){this._store||(this._store=e)}clone(...e){return new this.constructor(...e)}setPriority(e){this.priorityOverride=e}};es.defaultPriority=M.xV.Default;var er=class extends es{static get[M.By](){return M.lk.PlainExtensionConstructor}get[M.By](){return M.lk.PlainExtension}},en=class extends es{static get[M.By](){return M.lk.MarkExtensionConstructor}get[M.By](){return M.lk.MarkExtension}get type(){return(0,b.fp)(this.store.schema.marks,this.name)}constructor(...e){super(...e)}};en.disableExtraAttributes=!1;var ei=class extends es{static get[M.By](){return M.lk.NodeExtensionConstructor}get[M.By](){return M.lk.NodeExtension}get type(){return(0,b.fp)(this.store.schema.nodes,this.name)}constructor(...e){super(...e)}};ei.disableExtraAttributes=!1;var eo={priority:void 0,extraAttributes:{},disableExtraAttributes:!1,exclude:{}};function ea(e){return(0,O.gf)(e)&&(0,O.pI)(e,[M.lk.PlainExtension,M.lk.MarkExtension,M.lk.NodeExtension])}function el(e){return(0,O.gf)(e)&&(0,O.pI)(e,M.lk.PlainExtension)}function ed(e){return(0,O.gf)(e)&&(0,O.pI)(e,M.lk.NodeExtension)}function eu(e){return(0,O.gf)(e)&&(0,O.pI)(e,M.lk.MarkExtension)}function eh(e){return t=>{let{defaultOptions:s,customHandlerKeys:r,handlerKeys:n,staticKeys:i,defaultPriority:o,handlerKeyOptions:a,...l}=e,d=(0,b.RF)(t);for(let[u,h]of(s&&(d.defaultOptions=s),o&&(d.defaultPriority=o),a&&(d.handlerKeyOptions=a),d.staticKeys=i??[],d.handlerKeys=n??[],d.customHandlerKeys=r??[],Object.entries(l)))d[u]||(d[u]=h);return(0,b.RF)(d)}}var ec=class extends er{constructor(){super(...arguments),this.attributeList=[],this.attributeObject=(0,b.Ry)(),this.updateAttributes=(e=!0)=>{this.transformAttributes(),e&&this.store.commands.forceUpdate("attributes")}}get name(){return"attributes"}onCreate(){this.transformAttributes(),this.store.setExtensionStore("updateAttributes",this.updateAttributes)}transformAttributes(){var e,t,s;if(this.attributeObject=(0,b.Ry)(),null==(e=this.store.managerSettings.exclude)?void 0:e.attributes){this.store.setStoreKey("attributes",this.attributeObject);return}for(let r of(this.attributeList=[],this.store.extensions)){if(null==(t=r.options.exclude)?void 0:t.attributes)continue;let n=null==(s=r.createAttributes)?void 0:s.call(r),i={...n,class:Z(...r.classNames??[],null==n?void 0:n.class)};this.attributeList.unshift(i)}for(let o of this.attributeList)this.attributeObject={...this.attributeObject,...o,class:Z(this.attributeObject.class,o.class)};this.store.setStoreKey("attributes",this.attributeObject)}};function ep(e={}){return(t,s,r)=>{(t.decoratedHelpers??(t.decoratedHelpers={}))[s]=e}}function em(e={}){return(t,s,r)=>{(t.decoratedCommands??(t.decoratedCommands={}))[s]=e}}function eg(e){return(t,s,r)=>{(t.decoratedKeybindings??(t.decoratedKeybindings={}))[s]=e}}var ef=class{constructor(e){this.promiseCreator=e,this.failureHandlers=[],this.successHandlers=[],this.validateHandlers=[],this.generateCommand=()=>e=>{let t=!0,{view:s,tr:r,dispatch:n}=e;if(!s)return!1;for(let i of this.validateHandlers)if(!i({...e,dispatch(){}})){t=!1;break}if(!n||!t)return t;let o=this.promiseCreator(e);return o.then(e=>{this.runHandlers(this.successHandlers,{value:e,state:s.state,tr:s.state.tr,dispatch:s.dispatch,view:s})}).catch(e=>{this.runHandlers(this.failureHandlers,{error:e,state:s.state,tr:s.state.tr,dispatch:s.dispatch,view:s})}),n(r),!0}}validate(e,t="push"){return this.validateHandlers[t](e),this}success(e,t="push"){return this.successHandlers[t](e),this}failure(e,t="push"){return this.failureHandlers[t](e),this}runHandlers(e,t){var s;for(let r of e)if(!r({...t,dispatch(){}}))break;null==(s=t.dispatch)||s.call(t,t.tr)}};function ey(e){let{type:t,attrs:s,range:r,selection:n}=e;return e=>{let{dispatch:i,tr:o,state:a}=e,l=(0,b.HD)(t)?a.schema.marks[t]:t;if((0,b.kG)(l,{code:M.mA.SCHEMA,message:`Mark type: ${t} does not exist on the current schema.`}),r||n){let{from:d,to:u}=(0,O.b0)(n??r??o.selection,o.doc);return(0,O.yw)({trState:o,type:t,...r})?null==i||i(o.removeMark(d,u,l)):null==i||i(o.addMark(d,u,l.create(s))),!0}return(0,H.A_)((0,_.w9)(l,s))(e)}}var ev=class extends er{constructor(){super(...arguments),this.decorated=new Map,this.forceUpdateTransaction=(e,...t)=>{let{forcedUpdates:s}=this.getCommandMeta(e);return this.setCommandMeta(e,{forcedUpdates:(0,b.Nb)([...s,...t])}),e}}get name(){return"commands"}get transaction(){let e=this.store.getState();this._transaction||(this._transaction=e.tr);let t=this._transaction.before.eq(e.doc),s=!(0,b.yD)(this._transaction.steps);if(!t){let r=e.tr;if(s)for(let n of this._transaction.steps)r.step(n);this._transaction=r}return this._transaction}onCreate(){this.store.setStoreKey("getForcedUpdates",this.getForcedUpdates.bind(this))}onView(e){var t;let{extensions:s,helpers:r}=this.store,n=(0,b.Ry)(),i=new Set,o=(0,b.Ry)(),a=t=>{var s;let r=(0,b.Ry)(),i=()=>t??this.transaction,l=[];for(let[d,u]of Object.entries(n))null!=(s=o[d])&&s.disableChaining||(r[d]=this.chainedFactory({chain:r,command:u.original,getTr:i,getChain:()=>l}));let h=e=>{(0,b.kG)(e===i(),{message:"Chaining currently only supports `CommandFunction` methods which do not use the `state.tr` property. Instead you should use the provided `tr` property."})};return r.run=(t={})=>{let s=l;for(let r of(l=[],s))if(!r(h)&&t.exitEarly)return;e.dispatch(i())},r.tr=()=>{let e=l;for(let t of(l=[],e))t(h);return i()},r.enabled=()=>{for(let e of l)if(!e())return!1;return!0},r.new=e=>a(e),r};for(let l of s){let d=(null==(t=l.createCommands)?void 0:t.call(l))??{},u=l.decoratedCommands??{},h={};for(let[c,p]of(o={...o,decoratedCommands:u},Object.entries(u))){let m=(0,b.HD)(p.shortcut)&&p.shortcut.startsWith("_|")?{shortcut:r.getNamedShortcut(p.shortcut,l.options)}:void 0;this.updateDecorated(c,{...p,name:l.name,...m}),d[c]=l[c].bind(l),p.active&&(h[c]=()=>{var e;return(null==(e=p.active)?void 0:e.call(p,l.options,this.store))??!1})}(0,b.Qr)(d)||this.addCommands({active:h,names:i,commands:n,extensionCommands:d})}let g=a();for(let[f,y]of Object.entries(g))a[f]=y;this.store.setStoreKey("commands",n),this.store.setStoreKey("chain",a),this.store.setExtensionStore("commands",n),this.store.setExtensionStore("chain",a)}onStateUpdate({state:e}){this._transaction=e.tr}createPlugin(){return{}}customDispatch(e){return e}insertText(e,t={}){return(0,b.HD)(e)?function(e,t={}){return({tr:s,dispatch:r,state:n})=>{let i=n.schema,o=s.selection,{from:a=o.from,to:l=a??o.to,marks:d={}}=t;if(!r)return!0;s.insertText(e,a,l);let u=(0,b.fp)(s.steps,s.steps.length-1).getMap().map(l);for(let[h,c]of(0,b.qh)(d))s.addMark(a,u,(0,b.fp)(i.marks,h).create(c));return r(s),!0}}(e,t):this.store.createPlaceholderCommand({promise:e,placeholder:{type:"inline"},onSuccess:(e,s,r)=>this.insertText(e,{...t,...s})(r)}).generateCommand()}selectText(e,t={}){return({tr:s,dispatch:r})=>{let n=(0,O.b0)(e,s.doc),i=s.selection.anchor===n.anchor&&s.selection.head===n.head;return(!i||!!t.forceUpdate)&&(null==r||r(s.setSelection(n)),!0)}}selectMark(e){return t=>{let{tr:s}=t,r=(0,O.IH)(s.selection.$from,e);return!!r&&this.store.commands.selectText.original({from:r.from,to:r.to})(t)}}delete(e){return({tr:t,dispatch:s})=>{let{from:r,to:n}=e??t.selection;return null==s||s(t.delete(r,n)),!0}}emptyUpdate(e){return({tr:t,dispatch:s})=>(s&&(null==e||e(),s(t)),!0)}forceUpdate(...e){return({tr:t,dispatch:s})=>(null==s||s(this.forceUpdateTransaction(t,...e)),!0)}updateNodeAttributes(e,t){return({tr:s,dispatch:r})=>(null==r||r(s.setNodeMarkup(e,void 0,t)),!0)}setContent(e,t){return s=>{let{tr:r,dispatch:n}=s,i=this.store.manager.createState({content:e,selection:t});return!!i&&(null==n||n(r.replaceRangeWith(0,r.doc.nodeSize-2,i.doc)),!0)}}resetContent(){return e=>{let{tr:t,dispatch:s}=e,r=this.store.manager.createEmptyDoc();return r?this.setContent(r)(e):(null==s||s(t.delete(0,t.doc.nodeSize)),!0)}}emptySelection(){return({tr:e,dispatch:t})=>!e.selection.empty&&(null==t||t(e.setSelection(N.Bs.near(e.selection.$anchor))),!0)}insertNewLine(){return({dispatch:e,tr:t})=>!!(0,O.hT)(t.selection)&&(null==e||e(t.insertText("\n")),!0)}insertNode(e,t={}){return({dispatch:s,tr:r,state:n})=>{var i;let{attrs:o,range:a,selection:l,replaceEmptyParentBlock:d=!1}=t,{from:u,to:h,$from:c}=(0,O.b0)(l??a??r.selection,r.doc);if((0,O.PH)(e)||(0,O.mt)(e)){let p=c.before(c.depth);return null==s||s(d&&u===h&&(0,O.mp)(c.parent)?r.replaceWith(p,p+c.parent.nodeSize,e):r.replaceWith(u,h,e)),!0}let m=(0,b.HD)(e)?n.schema.nodes[e]:e;(0,b.kG)(m,{code:M.mA.SCHEMA,message:`The requested node type ${e} does not exist in the schema.`});let g=null==(i=t.marks)?void 0:i.map(e=>{if(e instanceof R.vc)return e;let t=(0,b.HD)(e)?n.schema.marks[e]:e;return(0,b.kG)(t,{code:M.mA.SCHEMA,message:`The requested mark type ${e} does not exist in the schema.`}),t.create()}),f=m.createAndFill(o,(0,b.HD)(t.content)?n.schema.text(t.content):t.content,g);return!!f&&(null==s||s(u!==h?r.replaceRangeWith(u,h,f):r.insert(u,f)),!0)}}focus(e){return t=>{let{dispatch:s,tr:r}=t,{view:n}=this.store;if(!1===e||n.hasFocus()&&(void 0===e||!0===e))return!1;if(void 0===e||!0===e){let{from:i=0,to:o=i}=r.selection;e={from:i,to:o}}return s&&this.delayedFocus(),this.selectText(e)(t)}}blur(e){return t=>{let{view:s}=this.store;return!!s.hasFocus()&&(requestAnimationFrame(()=>{s.dom.blur()}),!e||this.selectText(e)(t))}}setBlockNodeType(e,t,s,r=!0){return(0,O.uJ)(e,t,s,r)}toggleWrappingNode(e,t,s){return(0,O.bm)(e,t,s)}toggleBlockNodeItem(e){return(0,O.zU)(e)}wrapInNode(e,t,s){return(0,O.ym)(e,t,s)}applyMark(e,t,s){return({tr:r,dispatch:n,state:i})=>{let o=(0,O.b0)(s??r.selection,r.doc),a=(0,O.Lp)(o),l=(0,b.HD)(e)?i.schema.marks[e]:e;if((0,b.kG)(l,{code:M.mA.SCHEMA,message:`Mark type: ${e} does not exist on the current schema.`}),o.empty&&!a||!function(e,t,s){for(let{$from:r,$to:n}of s){let i=0===r.depth&&t.type.allowsMarkType(e);if(t.nodesBetween(r.pos,n.pos,t=>{if(i)return!1;i=t.inlineContent&&t.type.allowsMarkType(e)}),i)return!0}return!1}(l,r.doc,o.ranges))return!1;if(!n)return!0;if(a)return r.removeStoredMark(l),t&&r.addStoredMark(l.create(t)),n(r),!0;let d=!1;for(let{$from:u,$to:h}of o.ranges){if(d)break;d=r.doc.rangeHasMark(u.pos,h.pos,l)}for(let{$from:c,$to:p}of o.ranges)d&&r.removeMark(c.pos,p.pos,l),t&&r.addMark(c.pos,p.pos,l.create(t));return n(r),!0}}toggleMark(e){return ey(e)}removeMark(e){return(0,O.P9)(e)}setMeta(e,t){return({tr:s})=>(s.setMeta(e,t),!0)}selectAll(){return this.selectText("all")}copy(){return e=>!e.tr.selection.empty&&(e.dispatch&&document.execCommand("copy"),!0)}paste(){return this.store.createPlaceholderCommand({async promise(){var e;return(null==(e=navigator.clipboard)?void 0:e.readText)?await navigator.clipboard.readText():""},placeholder:{type:"inline"},onSuccess:(e,t,s)=>this.insertNode((0,O.OC)({content:e,schema:s.state.schema}),{selection:t})(s)}).generateCommand()}cut(){return e=>!e.tr.selection.empty&&(e.dispatch&&document.execCommand("cut"),!0)}replaceText(e){return(0,O.lp)(e)}getAllCommandOptions(){let e={};for(let[t,s]of this.decorated)(0,b.Qr)(s)||(e[t]=s);return e}getCommandOptions(e){return this.decorated.get(e)}getCommandProp(){return{tr:this.transaction,dispatch:this.store.view.dispatch,state:this.store.view.state,view:this.store.view}}updateDecorated(e,t){if(!t){this.decorated.delete(e);return}let s=this.decorated.get(e)??{name:""};this.decorated.set(e,{...s,...t})}handleIosFocus(){O.NZ.isIos&&this.store.view.dom.focus()}delayedFocus(){this.handleIosFocus(),requestAnimationFrame(()=>{this.store.view.focus(),this.store.view.dispatch(this.transaction.scrollIntoView())})}getForcedUpdates(e){return this.getCommandMeta(e).forcedUpdates}getCommandMeta(e){let t=e.getMeta(this.pluginKey)??{};return{...eS,...t}}setCommandMeta(e,t){let s=this.getCommandMeta(e);e.setMeta(this.pluginKey,{...s,...t})}addCommands(e){let{extensionCommands:t,commands:s,names:r,active:n}=e;for(let[i,o]of(0,b.qh)(t))Y({name:i,set:r,code:M.mA.DUPLICATE_COMMAND_NAMES}),(0,b.kG)(!ex.has(i),{code:M.mA.DUPLICATE_COMMAND_NAMES,message:"The command name you chose is forbidden."}),s[i]=this.createUnchainedCommand(o,n[i])}unchainedFactory(e){return(...t)=>{let s;let{shouldDispatch:r=!0,command:n}=e,{view:i}=this.store,{state:o}=i;return r&&(s=i.dispatch),n(...t)({state:o,dispatch:s,view:i,tr:o.tr})}}createUnchainedCommand(e,t){let s=this.unchainedFactory({command:e});return s.enabled=this.unchainedFactory({command:e,shouldDispatch:!1}),s.isEnabled=s.enabled,s.original=e,s.active=t,s}chainedFactory(e){return(...t)=>{let{chain:s,command:r,getTr:n,getChain:i}=e,o=i(),{view:a}=this.store,{state:l}=a;return o.push(e=>r(...t)({state:l,dispatch:e,view:a,tr:n()})),s}}};G([em()],ev.prototype,"customDispatch",1),G([em()],ev.prototype,"insertText",1),G([em()],ev.prototype,"selectText",1),G([em()],ev.prototype,"selectMark",1),G([em()],ev.prototype,"delete",1),G([em()],ev.prototype,"emptyUpdate",1),G([em()],ev.prototype,"forceUpdate",1),G([em()],ev.prototype,"updateNodeAttributes",1),G([em()],ev.prototype,"setContent",1),G([em()],ev.prototype,"resetContent",1),G([em()],ev.prototype,"emptySelection",1),G([em()],ev.prototype,"insertNewLine",1),G([em()],ev.prototype,"insertNode",1),G([em()],ev.prototype,"focus",1),G([em()],ev.prototype,"blur",1),G([em()],ev.prototype,"setBlockNodeType",1),G([em()],ev.prototype,"toggleWrappingNode",1),G([em()],ev.prototype,"toggleBlockNodeItem",1),G([em()],ev.prototype,"wrapInNode",1),G([em()],ev.prototype,"applyMark",1),G([em()],ev.prototype,"toggleMark",1),G([em()],ev.prototype,"removeMark",1),G([em()],ev.prototype,"setMeta",1),G([em({description:({t:e})=>e(T.Vb.SELECT_ALL_DESCRIPTION),label:({t:e})=>e(T.Vb.SELECT_ALL_LABEL),shortcut:M.vO.SelectAll})],ev.prototype,"selectAll",1),G([em({description:({t:e})=>e(T.Vb.COPY_DESCRIPTION),label:({t:e})=>e(T.Vb.COPY_LABEL),shortcut:M.vO.Copy,icon:"fileCopyLine"})],ev.prototype,"copy",1),G([em({description:({t:e})=>e(T.Vb.PASTE_DESCRIPTION),label:({t:e})=>e(T.Vb.PASTE_LABEL),shortcut:M.vO.Paste,icon:"clipboardLine"})],ev.prototype,"paste",1),G([em({description:({t:e})=>e(T.Vb.CUT_DESCRIPTION),label:({t:e})=>e(T.Vb.CUT_LABEL),shortcut:M.vO.Cut,icon:"scissorsFill"})],ev.prototype,"cut",1),G([em()],ev.prototype,"replaceText",1),G([ep()],ev.prototype,"getAllCommandOptions",1),G([ep()],ev.prototype,"getCommandOptions",1),G([ep()],ev.prototype,"getCommandProp",1),ev=G([eh({defaultPriority:M.xV.Highest,defaultOptions:{trackerClassName:"remirror-tracker-position",trackerNodeName:"span"},staticKeys:["trackerClassName","trackerNodeName"]})],ev);var eS={forcedUpdates:[]},ex=new Set(["run","chain","original","raw","enabled","tr","new"]),ek=class extends er{constructor(){super(...arguments),this.placeholders=K.EH.empty,this.placeholderWidgets=new Map,this.createPlaceholderCommand=e=>{let t=(0,b.EL)(),{promise:s,placeholder:r,onFailure:n,onSuccess:i}=e;return new ef(s).validate(e=>this.addPlaceholder(t,r)(e)).success(e=>{let{state:s,tr:r,dispatch:o,view:a,value:l}=e,d=this.store.helpers.findPlaceholder(t);if(!d){let u=Error("The placeholder has been removed");return(null==n?void 0:n({error:u,state:s,tr:r,dispatch:o,view:a}))??!1}return this.removePlaceholder(t)({state:s,tr:r,view:a,dispatch(){}}),i(l,d,{state:s,tr:r,dispatch:o,view:a})}).failure(e=>(this.removePlaceholder(t)({...e,dispatch(){}}),(null==n?void 0:n(e))??!1))}}get name(){return"decorations"}onCreate(){this.store.setExtensionStore("createPlaceholderCommand",this.createPlaceholderCommand)}createPlugin(){return{state:{init(){},apply:e=>{var t,s,r,n,i,o;let{added:a,clearTrackers:l,removed:d,updated:u}=this.getMeta(e);if(l){for(let[,h]of(this.placeholders=K.EH.empty,this.placeholderWidgets))null==(s=(t=h.spec).onDestroy)||s.call(t,this.store.view,h.spec.element);this.placeholderWidgets.clear();return}for(let[,c]of(this.placeholders=this.placeholders.map(e.mapping,e.doc,{onRemove:e=>{var t,s;let r=this.placeholderWidgets.get(e.id);r&&(null==(s=(t=r.spec).onDestroy)||s.call(t,this.store.view,r.spec.element))}}),this.placeholderWidgets))null==(n=(r=c.spec).onUpdate)||n.call(r,this.store.view,c.from,c.spec.element,c.spec.data);for(let p of a){if("inline"===p.type){this.addInlinePlaceholder(p,e);continue}if("node"===p.type){this.addNodePlaceholder(p,e);continue}if("widget"===p.type){this.addWidgetPlaceholder(p,e);continue}}for(let{id:m,data:g}of u){let f=this.placeholderWidgets.get(m);if(!f)continue;let y=K.p.widget(f.from,f.spec.element,{...f.spec,data:g});this.placeholders=this.placeholders.remove([f]).add(e.doc,[y]),this.placeholderWidgets.set(m,y)}for(let v of d){let S=this.placeholders.find(void 0,void 0,e=>e.id===v&&e.__type===eb),x=this.placeholderWidgets.get(v);x&&(null==(o=(i=x.spec).onDestroy)||o.call(i,this.store.view,x.spec.element)),this.placeholders=this.placeholders.remove(S),this.placeholderWidgets.delete(v)}}},props:{decorations:e=>{let t=this.options.decorations(e);for(let s of(t=t.add(e.doc,this.placeholders.find()),this.store.extensions)){if(!s.createDecorations)continue;let r=s.createDecorations(e).find();t=t.add(e.doc,r)}return t},handleDOMEvents:{blur:e=>(this.options.persistentSelectionClass&&e.dispatch(e.state.tr.setMeta(eM,!1)),!1),focus:e=>(this.options.persistentSelectionClass&&e.dispatch(e.state.tr.setMeta(eM,!0)),!1)}}}}updateDecorations(){return({tr:e,dispatch:t})=>(null==t||t(e),!0)}addPlaceholder(e,t,s){return({dispatch:r,tr:n})=>!!this.addPlaceholderTransaction(e,t,n,!r)&&(null==r||r(s?n.deleteSelection():n),!0)}updatePlaceholder(e,t){return({dispatch:s,tr:r})=>!!this.updatePlaceholderTransaction({id:e,data:t,tr:r,checkOnly:!s})&&(null==s||s(r),!0)}removePlaceholder(e){return({dispatch:t,tr:s})=>!!this.removePlaceholderTransaction({id:e,tr:s,checkOnly:!t})&&(null==t||t(s),!0)}clearPlaceholders(){return({tr:e,dispatch:t})=>!!this.clearPlaceholdersTransaction({tr:e,checkOnly:!t})&&(null==t||t(e),!0)}findPlaceholder(e){return this.findAllPlaceholders().get(e)}findAllPlaceholders(){let e=new Map,t=this.placeholders.find(void 0,void 0,e=>e.__type===eb);for(let s of t)e.set(s.spec.id,{from:s.from,to:s.to});return e}createDecorations(e){var t,s,r;let{persistentSelectionClass:n}=this.options;return!n||(null==(t=this.store.view)?void 0:t.hasFocus())||(null==(r=(s=this.store.helpers).isInteracting)?void 0:r.call(s))?K.EH.empty:function(e,t,s){let{selection:r,doc:n}=e;if(r.empty)return t;let{from:i,to:o}=r,a=(0,O.EG)(r)?K.p.node(i,o,s):K.p.inline(i,o,s);return t.add(n,[a])}(e,K.EH.empty,{class:(0,b.HD)(n)?n:"selection"})}onApplyState(){}addWidgetPlaceholder(e,t){let{pos:s,createElement:r,onDestroy:n,onUpdate:i,className:o,nodeName:a,id:l,type:d}=e,u=(null==r?void 0:r(this.store.view,s))??document.createElement(a);u.classList.add(o);let h=K.p.widget(s,u,{id:l,__type:eb,type:d,element:u,onDestroy:n,onUpdate:i});this.placeholderWidgets.set(l,h),this.placeholders=this.placeholders.add(t.doc,[h])}addInlinePlaceholder(e,t){let s;let{from:r=t.selection.from,to:n=t.selection.to,className:i,nodeName:o,id:a,type:l}=e;if(r===n){let d=document.createElement(o);d.classList.add(i),s=K.p.widget(r,d,{id:a,type:l,__type:eb,widget:d})}else s=K.p.inline(r,n,{nodeName:o,class:i},{id:a,__type:eb});this.placeholders=this.placeholders.add(t.doc,[s])}addNodePlaceholder(e,t){let{pos:s,className:r,nodeName:n,id:i}=e,o=(0,b.hj)(s)?t.doc.resolve(s):t.selection.$from,a=(0,b.hj)(s)?o.nodeAfter?{pos:s,end:o.nodeAfter.nodeSize}:void 0:(0,O.hK)(o);if(!a)return;let l=K.p.node(a.pos,a.end,{nodeName:n,class:r},{id:i,__type:eb});this.placeholders=this.placeholders.add(t.doc,[l])}withRequiredBase(e,t){let{placeholderNodeName:s,placeholderClassName:r}=this.options,{nodeName:n=s,className:i,...o}=t,a=(i?[r,i]:[r]).join(" ");return{nodeName:n,className:a,...o,id:e}}getMeta(e){let t=e.getMeta(this.pluginKey)??{};return{...eE,...t}}setMeta(e,t){let s=this.getMeta(e);e.setMeta(this.pluginKey,{...s,...t})}addPlaceholderTransaction(e,t,s,r=!1){let n=this.findPlaceholder(e);if(n)return!1;if(r)return!0;let{added:i}=this.getMeta(s);return this.setMeta(s,{added:[...i,this.withRequiredBase(e,t)]}),!0}updatePlaceholderTransaction(e){let{id:t,tr:s,checkOnly:r=!1,data:n}=e,i=this.findPlaceholder(t);if(!i)return!1;if(r)return!0;let{updated:o}=this.getMeta(s);return this.setMeta(s,{updated:(0,b.Nb)([...o,{id:t,data:n}])}),!0}removePlaceholderTransaction(e){let{id:t,tr:s,checkOnly:r=!1}=e,n=this.findPlaceholder(t);if(!n)return!1;if(r)return!0;let{removed:i}=this.getMeta(s);return this.setMeta(s,{removed:(0,b.Nb)([...i,t])}),!0}clearPlaceholdersTransaction(e){let{tr:t,checkOnly:s=!1}=e,r=this.getPluginState();return r!==K.EH.empty&&(!!s||(this.setMeta(t,{clearTrackers:!0}),!0))}};G([em()],ek.prototype,"updateDecorations",1),G([em()],ek.prototype,"addPlaceholder",1),G([em()],ek.prototype,"updatePlaceholder",1),G([em()],ek.prototype,"removePlaceholder",1),G([em()],ek.prototype,"clearPlaceholders",1),G([ep()],ek.prototype,"findPlaceholder",1),G([ep()],ek.prototype,"findAllPlaceholders",1),ek=G([eh({defaultOptions:{persistentSelectionClass:void 0,placeholderClassName:"placeholder",placeholderNodeName:"span"},staticKeys:["placeholderClassName","placeholderNodeName"],handlerKeys:["decorations"],handlerKeyOptions:{decorations:{reducer:{accumulator:(e,t,s)=>e.add(s.doc,t.find()),getDefault:()=>K.EH.empty}}},defaultPriority:M.xV.Low})],ek);var eE={added:[],updated:[],clearTrackers:!1,removed:[]},eb="placeholderDecoration",eM="persistentSelectionFocus",ew=class extends er{get name(){return"docChanged"}onStateUpdate(e){let{firstUpdate:t,transactions:s,tr:r}=e;!t&&(s??[r]).some(e=>null==e?void 0:e.docChanged)&&this.options.docChanged(e)}};ew=G([eh({handlerKeys:["docChanged"],handlerKeyOptions:{docChanged:{earlyReturnValue:!1}},defaultPriority:M.xV.Lowest})],ew);var eO=class extends er{get name(){return"helpers"}onCreate(){var e;this.store.setStringHandler("text",this.textToProsemirrorNode.bind(this)),this.store.setStringHandler("html",O.OC);let t=(0,b.Ry)(),s=(0,b.Ry)(),r=(0,b.Ry)(),n=new Set;for(let i of this.store.extensions){ed(i)&&(s[i.name]=e=>(0,O.Ig)({state:this.store.getState(),type:i.type,attrs:e}),r[i.name]=e=>{var t;return null==(t=(0,O.EM)({state:this.store.getState(),type:i.type,attrs:e}))?void 0:t.node.attrs}),eu(i)&&(s[i.name]=e=>(0,O.yw)({trState:this.store.getState(),type:i.type,attrs:e}),r[i.name]=e=>{let t=(0,O.IH)(this.store.getState().selection.$from,i.type);return t&&e?(0,O.V1)(t.mark,e)?t.mark.attrs:void 0:null==t?void 0:t.mark.attrs});let o=(null==(e=i.createHelpers)?void 0:e.call(i))??{};for(let a of Object.keys(i.decoratedHelpers??{}))o[a]=i[a].bind(i);if(!(0,b.Qr)(o))for(let[l,d]of(0,b.qh)(o))Y({name:l,set:n,code:M.mA.DUPLICATE_HELPER_NAMES}),t[l]=d}this.store.setStoreKey("attrs",r),this.store.setStoreKey("active",s),this.store.setStoreKey("helpers",t),this.store.setExtensionStore("attrs",r),this.store.setExtensionStore("active",s),this.store.setExtensionStore("helpers",t)}isSelectionEmpty(e=this.store.getState()){return(0,O.Ab)(e)}isViewEditable(e=this.store.getState()){var t,s;return(null==(s=(t=this.store.view.props).editable)?void 0:s.call(t,e))??!1}getStateJSON(e=this.store.getState()){return e.toJSON()}getJSON(e=this.store.getState()){return e.doc.toJSON()}getRemirrorJSON(e=this.store.getState()){return this.getJSON(e)}insertHtml(e,t){return s=>{let{state:r}=s,n=(0,O.OC)({content:e,schema:r.schema,fragment:!0});return this.store.commands.insertNode.original(n,t)(s)}}getText({lineBreakDivider:e="\n\n",state:t=this.store.getState()}={}){return t.doc.textBetween(0,t.doc.content.size,e,M.Vp)}getTextBetween(e,t,s=this.store.getState().doc){return s.textBetween(e,t,"\n\n",M.Vp)}getHTML(e=this.store.getState()){return(0,O.Em)(e.doc,this.store.document)}textToProsemirrorNode(e){let t=`<pre>${e.content}</pre>`;return this.store.stringHandlers.html({...e,content:t})}};G([ep()],eO.prototype,"isSelectionEmpty",1),G([ep()],eO.prototype,"isViewEditable",1),G([ep()],eO.prototype,"getStateJSON",1),G([ep()],eO.prototype,"getJSON",1),G([ep()],eO.prototype,"getRemirrorJSON",1),G([em()],eO.prototype,"insertHtml",1),G([ep()],eO.prototype,"getText",1),G([ep()],eO.prototype,"getTextBetween",1),G([ep()],eO.prototype,"getHTML",1),eO=G([eh({})],eO);var eA=class extends er{get name(){return"inputRules"}onCreate(){this.store.setExtensionStore("rebuildInputRules",this.rebuildInputRules.bind(this))}createExternalPlugins(){return[this.generateInputRulesPlugin()]}generateInputRulesPlugin(){var e,t;let s=[],r=this.store.markTags[M.eX.ExcludeInputRules];for(let n of this.store.extensions)if((null==(e=this.store.managerSettings.exclude)||!e.inputRules)&&n.createInputRules&&(null==(t=n.options.exclude)||!t.inputRules))for(let i of n.createInputRules())i.shouldSkip=this.options.shouldSkipInputRule,i.invalidMarks=r,s.push(i);return(0,D.Hw)({rules:s})}rebuildInputRules(){this.store.updateExtensionPlugins(this)}};eA=G([eh({defaultPriority:M.xV.Default,handlerKeys:["shouldSkipInputRule"],handlerKeyOptions:{shouldSkipInputRule:{earlyReturnValue:!0}}})],eA);var eP=class extends er{constructor(){super(...arguments),this.extraKeyBindings=[],this.backwardMarkExitTracker=new Map,this.keydownHandler=null,this.onAddCustomHandler=({keymap:e})=>{var t,s;if(e)return this.extraKeyBindings=[...this.extraKeyBindings,e],null==(s=(t=this.store).rebuildKeymap)||s.call(t),()=>{var t,s;this.extraKeyBindings=this.extraKeyBindings.filter(t=>t!==e),null==(s=(t=this.store).rebuildKeymap)||s.call(t)}},this.rebuildKeymap=()=>{this.setupKeydownHandler()}}get name(){return"keymap"}get shortcutMap(){let{shortcuts:e}=this.options;return(0,b.HD)(e)?eH[e]:e}onCreate(){this.store.setExtensionStore("rebuildKeymap",this.rebuildKeymap)}createExternalPlugins(){var e;return(null==(e=this.store.managerSettings.exclude)?void 0:e.keymap)?[]:(this.setupKeydownHandler(),[new N.Sy({props:{handleKeyDown:(e,t)=>{var s;return null==(s=this.keydownHandler)?void 0:s.call(this,e,t)}}})])}setupKeydownHandler(){let e=this.generateKeymapBindings();this.keydownHandler=(0,I.$)(e)}generateKeymapBindings(){var e;let t=[],s=this.shortcutMap,r=this.store.getExtension(ev),n=e=>t=>eC({shortcut:t,map:s,store:this.store,options:e.options});for(let i of this.store.extensions){let o=i.decoratedKeybindings??{};if(null==(e=i.options.exclude)||!e.keymap)for(let[a,l]of(i.createKeymap&&t.push(function(e,t){let s,r;let n={};for(let[i,o]of((0,b.kJ)(e)?[r,s]=e:s=e,(0,b.qh)(s)))n[eT(i,t)]=o;return(0,b.o8)(r)?n:[r,n]}(i.createKeymap(n(i)),s)),(0,b.qh)(o))){if(l.isActive&&!l.isActive(i.options,this.store))continue;let d=i[a].bind(i),u=eC({shortcut:l.shortcut,map:s,options:i.options,store:this.store}),h=(0,b.mf)(l.priority)?l.priority(i.options,this.store):l.priority??M.xV.Low,c=(0,b.Ry)();for(let p of u)c[p]=d;t.push([h,c]),l.command&&r.updateDecorated(l.command,{shortcut:u})}}let m=this.sortKeymaps([...this.extraKeyBindings,...t]),g=(0,O.bk)(m);return g}arrowRightShortcut(e){let t=this.store.markTags[M.eX.PreventExits],s=this.store.nodeTags[M.eX.PreventExits];return this.exitMarkForwards(t,s)(e)}arrowLeftShortcut(e){let t=this.store.markTags[M.eX.PreventExits],s=this.store.nodeTags[M.eX.PreventExits];return(0,O.Q2)(this.exitNodeBackwards(s),this.exitMarkBackwards(t,s))(e)}backspace(e){let t=this.store.markTags[M.eX.PreventExits],s=this.store.nodeTags[M.eX.PreventExits];return(0,O.Q2)(this.exitNodeBackwards(s,!0),this.exitMarkBackwards(t,s,!0))(e)}createKeymap(){let{selectParentNodeOnEscape:e,undoInputRuleOnBackspace:t,excludeBaseKeymap:s}=this.options,r=(0,b.Ry)();if(!s)for(let[n,i]of(0,b.qh)(_.YR))r[n]=(0,H.A_)(i);return t&&_.YR.Backspace&&(r.Backspace=(0,H.A_)((0,_.QF)(D.dU,_.YR.Backspace))),e&&(r.Escape=(0,H.A_)(_.N0)),[M.xV.Low,r]}getNamedShortcut(e,t={}){return e.startsWith("_|")?eC({shortcut:e,map:this.shortcutMap,store:this.store,options:t}):[e]}onSetOptions(e){var t,s;let{changes:r}=e;(r.excludeBaseKeymap.changed||r.selectParentNodeOnEscape.changed||r.undoInputRuleOnBackspace.changed)&&(null==(s=(t=this.store).rebuildKeymap)||s.call(t))}sortKeymaps(e){return(0,b.DY)(e.map(e=>(0,b.kJ)(e)?e:[M.xV.Default,e]),(e,t)=>t[0]-e[0]).map(e=>e[1])}exitMarkForwards(e,t){return s=>{let{tr:r,dispatch:n}=s;if(!(0,O.OA)(r.selection))return!1;let i=(0,O.Tr)({selection:r.selection,types:t});if(i)return!1;let o=r.selection.$from,a=o.marks().filter(t=>!e.includes(t.type.name));if((0,b.yD)(a))return!1;if(!n)return!0;for(let l of a)r.removeStoredMark(l);return n(r.insertText(" ",r.selection.from)),!0}}exitNodeBackwards(e,t=!1){return s=>{let{tr:r}=s,n=t?O.GK:O.sg;if(!n(r.selection))return!1;let i=r.selection.$anchor.node();return!(!(0,O.mp)(i)||(0,O.xN)(i)||e.includes(i.type.name))&&this.store.commands.toggleBlockNodeItem.original({type:i.type})(s)}}exitMarkBackwards(e,t,s=!1){return r=>{let{tr:n,dispatch:i}=r,o=s?O.GK:O.sg;if(!o(n.selection)||this.backwardMarkExitTracker.has(n.selection.anchor))return this.backwardMarkExitTracker.clear(),!1;let a=(0,O.Tr)({selection:n.selection,types:t});if(a)return!1;let l=[...n.storedMarks??[],...n.selection.$from.marks()].filter(t=>!e.includes(t.type.name));if((0,b.yD)(l))return!1;if(!i)return!0;for(let d of l)n.removeStoredMark(d);return this.backwardMarkExitTracker.set(n.selection.anchor,!0),i(n),!0}}};function eC({shortcut:e,map:t,options:s,store:r}){return(0,b.HD)(e)?[eT(e,t)]:(0,b.kJ)(e)?e.map(e=>eT(e,t)):(e=e(s,r),eC({shortcut:e,map:t,options:s,store:r}))}function eT(e,t){return(0,b.q9)((0,b.VO)(M.vO),e)?t[e]:e}G([eg({shortcut:"ArrowRight",isActive:e=>e.exitMarksOnArrowPress})],eP.prototype,"arrowRightShortcut",1),G([eg({shortcut:"ArrowLeft",isActive:e=>e.exitMarksOnArrowPress})],eP.prototype,"arrowLeftShortcut",1),G([eg({shortcut:"Backspace",isActive:e=>e.exitMarksOnArrowPress})],eP.prototype,"backspace",1),G([ep()],eP.prototype,"getNamedShortcut",1),eP=G([eh({defaultPriority:M.xV.Low,defaultOptions:{shortcuts:"default",undoInputRuleOnBackspace:!0,selectParentNodeOnEscape:!1,excludeBaseKeymap:!1,exitMarksOnArrowPress:!0},customHandlerKeys:["keymap"]})],eP);var eR={[M.vO.Copy]:"Mod-c",[M.vO.Cut]:"Mod-x",[M.vO.Paste]:"Mod-v",[M.vO.PastePlain]:"Mod-Shift-v",[M.vO.SelectAll]:"Mod-a",[M.vO.Undo]:"Mod-z",[M.vO.Redo]:O.NZ.isMac?"Shift-Mod-z":"Mod-y",[M.vO.Bold]:"Mod-b",[M.vO.Italic]:"Mod-i",[M.vO.Underline]:"Mod-u",[M.vO.Strike]:"Mod-d",[M.vO.Code]:"Mod-`",[M.vO.Paragraph]:"Mod-Shift-0",[M.vO.H1]:"Mod-Shift-1",[M.vO.H2]:"Mod-Shift-2",[M.vO.H3]:"Mod-Shift-3",[M.vO.H4]:"Mod-Shift-4",[M.vO.H5]:"Mod-Shift-5",[M.vO.H6]:"Mod-Shift-6",[M.vO.TaskList]:"Mod-Shift-7",[M.vO.BulletList]:"Mod-Shift-8",[M.vO.OrderedList]:"Mod-Shift-9",[M.vO.Quote]:"Mod->",[M.vO.Divider]:"Mod-Shift-|",[M.vO.Codeblock]:"Mod-Shift-~",[M.vO.ClearFormatting]:"Mod-Shift-C",[M.vO.Superscript]:"Mod-.",[M.vO.Subscript]:"Mod-,",[M.vO.LeftAlignment]:"Mod-Shift-L",[M.vO.CenterAlignment]:"Mod-Shift-E",[M.vO.RightAlignment]:"Mod-Shift-R",[M.vO.JustifyAlignment]:"Mod-Shift-J",[M.vO.InsertLink]:"Mod-k",[M.vO.Find]:"Mod-f",[M.vO.FindBackwards]:"Mod-Shift-f",[M.vO.FindReplace]:"Mod-Shift-H",[M.vO.AddFootnote]:"Mod-Alt-f",[M.vO.AddComment]:"Mod-Alt-m",[M.vO.ContextMenu]:"Mod-Shift-\\",[M.vO.IncreaseFontSize]:"Mod-Shift-.",[M.vO.DecreaseFontSize]:"Mod-Shift-,",[M.vO.IncreaseIndent]:"Tab",[M.vO.DecreaseIndent]:"Shift-Tab",[M.vO.Shortcuts]:"Mod-/",[M.vO.Format]:O.NZ.isMac?"Alt-Shift-f":"Shift-Ctrl-f"},eN={...eR,[M.vO.Strike]:"Mod-Shift-S",[M.vO.Code]:"Mod-Shift-M",[M.vO.Paragraph]:"Mod-Alt-0",[M.vO.H1]:"Mod-Alt-1",[M.vO.H2]:"Mod-Alt-2",[M.vO.H3]:"Mod-Alt-3",[M.vO.H4]:"Mod-Alt-4",[M.vO.H5]:"Mod-Alt-5",[M.vO.H6]:"Mod-Alt-6",[M.vO.OrderedList]:"Mod-Alt-7",[M.vO.BulletList]:"Mod-Alt-8",[M.vO.Quote]:"Mod-Alt-9",[M.vO.ClearFormatting]:"Mod-\\",[M.vO.IncreaseIndent]:"Mod-[",[M.vO.DecreaseIndent]:"Mod-]"},eH={default:eR,googleDoc:eN},e_=class extends er{get name(){return"nodeViews"}createPlugin(){let e=[],t=(0,b.Ry)();for(let s of this.store.extensions){if(!s.createNodeViews)continue;let r=s.createNodeViews();e.unshift((0,b.mf)(r)?{[s.name]:r}:r)}for(let n of(e.unshift(this.store.managerSettings.nodeViews??{}),e))Object.assign(t,n);return{props:{nodeViews:t}}}},eK=class extends er{get name(){return"pasteRules"}createExternalPlugins(){return[this.generatePasteRulesPlugin()]}generatePasteRulesPlugin(){var e,t;let s=[];for(let r of this.store.extensions){if((null==(e=this.store.managerSettings.exclude)?void 0:e.pasteRules)||!r.createPasteRules||(null==(t=r.options.exclude)?void 0:t.pasteRules))continue;let n=r.createPasteRules(),i=(0,b.kJ)(n)?n:[n];s.push(...i)}return(0,L.N)(s)}},eD=class extends er{constructor(){super(...arguments),this.plugins=[],this.managerPlugins=[],this.applyStateHandlers=[],this.initStateHandlers=[],this.appendTransactionHandlers=[],this.pluginKeys=(0,b.Ry)(),this.stateGetters=new Map,this.getPluginStateCreator=e=>t=>e.getState(t??this.store.getState()),this.getStateByName=e=>{let t=this.stateGetters.get(e);return(0,b.kG)(t,{message:"No plugin exists for the requested extension name."}),t()}}get name(){return"plugins"}onCreate(){let{setStoreKey:e,setExtensionStore:t,managerSettings:s,extensions:r}=this.store;this.updateExtensionStore();let{plugins:n=[]}=s;for(let i of(this.updatePlugins(n,this.managerPlugins),r))i.onApplyState&&this.applyStateHandlers.push(i.onApplyState.bind(i)),i.onInitState&&this.initStateHandlers.push(i.onInitState.bind(i)),i.onAppendTransaction&&this.appendTransactionHandlers.push(i.onAppendTransaction.bind(i)),this.extractExtensionPlugins(i);this.managerPlugins=n,this.store.setStoreKey("plugins",this.plugins),e("pluginKeys",this.pluginKeys),e("getPluginState",this.getStateByName),t("getPluginState",this.getStateByName)}createPlugin(){return{appendTransaction:(e,t,s)=>{let r=s.tr,n={previousState:t,tr:r,transactions:e,state:s};for(let i of this.appendTransactionHandlers)i(n);return this.options.appendTransaction(n),r.docChanged||r.steps.length>0||r.selectionSet||r.storedMarksSet?r:void 0},state:{init:(e,t)=>{for(let s of this.initStateHandlers)s(t)},apply:(e,t,s,r)=>{let n={previousState:s,state:r,tr:e};for(let i of this.applyStateHandlers)i(n);this.options.applyState(n)}}}}extractExtensionPlugins(e){var t,s;let r=!e.createPlugin&&!e.createExternalPlugins;if(!r&&(null==(t=this.store.managerSettings.exclude)||!t.plugins)&&(null==(s=e.options.exclude)||!s.plugins)){if(e.createPlugin){let n=new N.H$(e.name);this.pluginKeys[e.name]=n;let i=this.getPluginStateCreator(n);e.pluginKey=n,e.getPluginState=i,this.stateGetters.set(e.name,i),this.stateGetters.set(e.constructor,i);let o={...e.createPlugin(),key:n},a=new N.Sy(o);this.updatePlugins([a],e.plugin?[e.plugin]:void 0),e.plugin=a}if(e.createExternalPlugins){let l=e.createExternalPlugins();this.updatePlugins(l,e.externalPlugins),e.externalPlugins=l}}}updatePlugins(e,t){if(!t||(0,b.yD)(t)){this.plugins=[...this.plugins,...e];return}if(e.length!==t.length){this.plugins=[...this.plugins.filter(e=>!t.includes(e)),...e];return}let s=new Map;for(let[r,n]of e.entries())s.set((0,b.fp)(t,r),n);this.plugins=this.plugins.map(e=>t.includes(e)?s.get(e):e)}updateExtensionStore(){let{setExtensionStore:e}=this.store;e("updatePlugins",this.updatePlugins.bind(this)),e("dispatchPluginUpdate",this.dispatchPluginUpdate.bind(this)),e("updateExtensionPlugins",this.updateExtensionPlugins.bind(this))}updateExtensionPlugins(e){let t=ea(e)?e:(0,O.gf)(e)&&(0,O.pI)(e,[M.lk.PlainExtensionConstructor,M.lk.MarkExtensionConstructor,M.lk.NodeExtensionConstructor])?this.store.manager.getExtension(e):this.store.extensions.find(t=>t.name===e);(0,b.kG)(t,{code:M.mA.INVALID_MANAGER_EXTENSION,message:`The extension ${e} does not exist within the editor.`}),this.extractExtensionPlugins(t),this.store.setStoreKey("plugins",this.plugins),this.dispatchPluginUpdate()}dispatchPluginUpdate(){(0,b.kG)(this.store.phase>=M.RC.EditorView,{code:M.mA.MANAGER_PHASE_ERROR,message:"`dispatchPluginUpdate` should only be called after the view has been added to the manager."});let{view:e,updateState:t}=this.store,s=e.state.reconfigure({plugins:this.plugins});t(s)}};eD=G([eh({defaultPriority:M.xV.Highest,handlerKeys:["applyState","appendTransaction"]})],eD);var eI=class extends er{constructor(){super(...arguments),this.dynamicAttributes={marks:(0,b.Ry)(),nodes:(0,b.Ry)()}}get name(){return"schema"}onCreate(){let{managerSettings:e,tags:t,markNames:s,nodeNames:r,extensions:n}=this.store,{defaultBlockNode:i,disableExtraAttributes:o,nodeOverride:a,markOverride:l}=e;if(e.schema){let{nodes:d,marks:u}=function(e){let t=(0,b.Ry)(),s=(0,b.Ry)();for(let[r,n]of Object.entries(e.nodes))t[r]=n.spec;for(let[i,o]of Object.entries(e.marks))s[i]=o.spec;return{nodes:t,marks:s}}(e.schema);this.addSchema(e.schema,d,u);return}let h=i&&t[M.eX.Block].includes(i)?{doc:(0,b.Ry)(),[i]:(0,b.Ry)()}:(0,b.Ry)(),c=(0,b.Ry)(),p=function(e){let{settings:t,gatheredSchemaAttributes:s,nodeNames:r,markNames:n,tags:i}=e,o=(0,b.Ry)();if(t.disableExtraAttributes)return o;let a=[...s,...t.extraAttributes??[]];for(let l of a??[]){let d=function(e){let{identifiers:t,nodeNames:s,markNames:r,tags:n}=e;if("nodes"===t)return s;if("marks"===t)return r;if("all"===t)return[...s,...r];if((0,b.kJ)(t))return t;(0,b.kG)((0,b.PO)(t)&&(0,b.kJ)(t.tags),{code:M.mA.EXTENSION_EXTRA_ATTRIBUTES,message:"Invalid value passed as an identifier when creating `extraAttributes`."});let{tags:i=[],names:o=[],behavior:a="any",excludeNames:l,excludeTags:d,type:u}=t,h=new Set,c="mark"===u?r:"node"===u?s:[...r,...s],p=e=>c.includes(e)&&!(null==l?void 0:l.includes(e));for(let m of o)p(m)&&h.add(m);let g=new Map;for(let f of i)if(null==d||!d.includes(f))for(let y of n[f]){if(!p(y))continue;if("any"===a){h.add(y);continue}let v=g.get(y)??new Set;v.add(f),g.set(y,v)}for(let[S,x]of g)x.size===i.length&&h.add(S);return[...h]}({identifiers:l.identifiers,nodeNames:r,markNames:n,tags:i});for(let u of d){let h=o[u]??{};o[u]={...h,...l.attributes}}}return o}({settings:e,gatheredSchemaAttributes:this.gatherExtraAttributes(n),nodeNames:r,markNames:s,tags:t});for(let m of n){p[m.name]={...p[m.name],...m.options.extraAttributes};let g=!0===o||!0===m.options.disableExtraAttributes||!0===m.constructor.disableExtraAttributes;if(ed(m)){let{spec:f,dynamic:y}=eL({createExtensionSpec:(e,t)=>m.createNodeSpec(e,t),extraAttributes:(0,b.fp)(p,m.name),override:{...a,...m.options.nodeOverride},ignoreExtraAttributes:g,name:m.constructorName,tags:m.tags});m.spec=f,h[m.name]=f,Object.keys(y).length>0&&(this.dynamicAttributes.nodes[m.name]=y)}if(eu(m)){let{spec:v,dynamic:S}=eL({createExtensionSpec:(e,t)=>m.createMarkSpec(e,t),extraAttributes:(0,b.fp)(p,m.name),override:{...l,...m.options.markOverride},ignoreExtraAttributes:g,name:m.constructorName,tags:m.tags??[]});m.spec=v,c[m.name]=v,Object.keys(S).length>0&&(this.dynamicAttributes.marks[m.name]=S)}}let x=new R.V_({nodes:h,marks:c,topNode:"doc"});this.addSchema(x,h,c)}createPlugin(){return{appendTransaction:(e,t,s)=>{let{tr:r}=s,n=e.some(e=>e.docChanged);return n&&(0!==Object.keys(this.dynamicAttributes.nodes).length||0!==Object.keys(this.dynamicAttributes.marks).length)?(r.doc.descendants((e,t)=>(this.checkAndUpdateDynamicNodes(e,t,r),this.checkAndUpdateDynamicMarks(e,t,r),!0)),r.steps.length>0?r:null):null}}}addSchema(e,t,s){for(let r of(this.store.setStoreKey("nodes",t),this.store.setStoreKey("marks",s),this.store.setStoreKey("schema",e),this.store.setExtensionStore("schema",e),this.store.setStoreKey("defaultBlockNode",(0,O.JN)(e).name),Object.values(e.nodes)))if("doc"!==r.name&&(r.isBlock||r.isTextblock))break}checkAndUpdateDynamicNodes(e,t,s){for(let[r,n]of(0,b.qh)(this.dynamicAttributes.nodes))if(e.type.name===r)for(let[i,o]of(0,b.qh)(n)){if(!(0,b.le)(e.attrs[i]))continue;let a={...e.attrs,[i]:o(e)};s.setNodeMarkup(t,void 0,a),(0,V.gn)(s)}}checkAndUpdateDynamicMarks(e,t,s){for(let[r,n]of(0,b.qh)(this.dynamicAttributes.marks)){let i=(0,b.fp)(this.store.schema.marks,r),o=e.marks.find(e=>e.type.name===r);if(o)for(let[a,l]of(0,b.qh)(n)){if(!(0,b.le)(o.attrs[a]))continue;let d=(0,O.IH)(s.doc.resolve(t),i);if(!d)continue;let{from:u,to:h}=d,c=i.create({...o.attrs,[a]:l(o)});s.removeMark(u,h,i).addMark(u,h,c),(0,V.gn)(s)}}}gatherExtraAttributes(e){let t=[];for(let s of e)s.createSchemaAttributes&&t.push(...s.createSchemaAttributes());return t}};function eL(e){var t,s,r;let{createExtensionSpec:n,extraAttributes:i,ignoreExtraAttributes:o,name:a,tags:l,override:d}=e,u=(0,b.Ry)(),h=!1,c=(s=function(){h=!0},r=function(e,t){u[e]=t},()=>{s();let e=(0,b.Ry)();if(o)return e;for(let[t,n]of(0,b.qh)(i)){let a=eV(n),l=a.default;(0,b.mf)(l)&&(r(t,l),l=null),e[t]=void 0===l?{}:{default:l}}return e}),p=e=>{let t=(0,b.Ry)();if(o)return t;for(let[s,r]of(0,b.qh)(i)){let{parseDOM:n,...a}=eV(r);if((0,O.jd)(e)){if((0,b.le)(n)){t[s]=e.getAttribute(s)??a.default;continue}if((0,b.mf)(n)){t[s]=n(e)??a.default;continue}t[s]=e.getAttribute(n)??a.default}}return t},m=e=>{let t=(0,b.Ry)();if(o)return t;function s(s,r){if(s){if((0,b.HD)(s)){t[r]=s;return}if((0,b.kJ)(s)){let[n,i]=s;t[n]=i??e.attrs[r];return}for(let[o,a]of(0,b.qh)(s))t[o]=a}}for(let[r,n]of(0,b.qh)(i)){let{toDOM:a,parseDOM:l}=eV(n);if((0,b.le)(a)){let d=(0,b.HD)(l)?l:r;t[d]=e.attrs[r];continue}if((0,b.mf)(a)){s(a(e.attrs,(0,O.PH)(e)?{node:e}:(0,O.K_)(e)?{mark:e}:{}),r);continue}s(a,r)}return t},g=n({defaults:c,parse:p,dom:m},d);return(0,b.kG)(o||h,{code:M.mA.EXTENSION_SPEC,message:`When creating a node specification you must call the 'defaults', and parse, and 'dom' methods. To avoid this error you can set the static property 'disableExtraAttributes' of '${a}' to 'true'.`}),g.group=[...(null==(t=g.group)?void 0:t.split(" "))??[],...l].join(" ")||void 0,{spec:g,dynamic:u}}function eV(e){return(0,b.HD)(e)||(0,b.mf)(e)?{default:e}:((0,b.kG)(e,{message:`${(0,b.BB)(e)} is not supported`,code:M.mA.EXTENSION_EXTRA_ATTRIBUTES}),e)}eI=G([eh({defaultPriority:M.xV.Highest})],eI);var eB=class extends er{constructor(){super(...arguments),this.onAddCustomHandler=({suggester:e})=>{var t;if(e&&(null==(t=this.store.managerSettings.exclude)||!t.suggesters))return(0,V.Ek)(this.store.getState(),e)}}get name(){return"suggest"}onCreate(){this.store.setExtensionStore("addSuggester",e=>(0,V.Ek)(this.store.getState(),e)),this.store.setExtensionStore("removeSuggester",e=>(0,V.C$)(this.store.getState(),e))}createExternalPlugins(){var e,t;let s=[];for(let r of this.store.extensions){if(null==(e=this.store.managerSettings.exclude)?void 0:e.suggesters)break;if(!r.createSuggesters||(null==(t=r.options.exclude)?void 0:t.suggesters))continue;let n=r.createSuggesters(),i=(0,b.kJ)(n)?n:[n];s.push(...i)}return[(0,V.D7)(...s)]}getSuggestState(e){return(0,V.hu)(e??this.store.getState())}getSuggestMethods(){let{addIgnored:e,clearIgnored:t,removeIgnored:s,ignoreNextExit:r,setMarkRemoved:n,findMatchAtPosition:i,findNextTextSelection:o,setLastChangeFromAppend:a}=this.getSuggestState();return{addIgnored:e,clearIgnored:t,removeIgnored:s,ignoreNextExit:r,setMarkRemoved:n,findMatchAtPosition:i,findNextTextSelection:o,setLastChangeFromAppend:a}}isSuggesterActive(e){var t;return(0,b.q9)((0,b.kJ)(e)?e:[e],null==(t=this.getSuggestState().match)?void 0:t.suggester.name)}};G([ep()],eB.prototype,"getSuggestState",1),G([ep()],eB.prototype,"getSuggestMethods",1),G([ep()],eB.prototype,"isSuggesterActive",1),eB=G([eh({customHandlerKeys:["suggester"]})],eB);var eF=class extends er{constructor(){super(...arguments),this.allTags=(0,b.Ry)(),this.plainTags=(0,b.Ry)(),this.markTags=(0,b.Ry)(),this.nodeTags=(0,b.Ry)()}get name(){return"tags"}onCreate(){for(let e of(this.resetTags(),this.store.extensions))this.updateTagForExtension(e);this.store.setStoreKey("tags",this.allTags),this.store.setExtensionStore("tags",this.allTags),this.store.setStoreKey("plainTags",this.plainTags),this.store.setExtensionStore("plainTags",this.plainTags),this.store.setStoreKey("markTags",this.markTags),this.store.setExtensionStore("markTags",this.markTags),this.store.setStoreKey("nodeTags",this.nodeTags),this.store.setExtensionStore("nodeTags",this.nodeTags)}resetTags(){let e=(0,b.Ry)(),t=(0,b.Ry)(),s=(0,b.Ry)(),r=(0,b.Ry)();for(let n of(0,b.VO)(M.eX))e[n]=[],t[n]=[],s[n]=[],r[n]=[];this.allTags=e,this.plainTags=t,this.markTags=s,this.nodeTags=r}updateTagForExtension(e){var t,s,r;let n=new Set([...e.tags??[],...(null==(t=e.createTags)?void 0:t.call(e))??[],...e.options.extraTags??[],...(null==(s=this.store.managerSettings.extraTags)?void 0:s[e.name])??[]]);for(let i of n)(0,b.kG)((r=i,(0,b.q9)((0,b.VO)(M.eX),r)),{code:M.mA.EXTENSION,message:`The tag provided by the extension: ${e.constructorName} is not supported by the editor. To add custom tags you can use the 'mutateTag' method.`}),this.allTags[i].push(e.name),el(e)&&this.plainTags[i].push(e.name),eu(e)&&this.markTags[i].push(e.name),ed(e)&&this.nodeTags[i].push(e.name);e.tags=[...n]}};eF=G([eh({defaultPriority:M.xV.Highest})],eF);var eU=new N.H$("remirrorFilePlaceholderPlugin"),eW=class extends er{get name(){return"upload"}createExternalPlugins(){return[function(){let e=new N.Sy({key:eU,state:{init:()=>({set:K.EH.empty,payloads:new Map}),apply(t,{set:s,payloads:r}){s=s.map(t.mapping,t.doc);let n=t.getMeta(e);if(n){if(0===n.type){let i=document.createElement("placeholder"),o=K.p.widget(n.pos,i,{id:n.id});s=s.add(t.doc,[o]),r.set(n.id,n.payload)}else 1===n.type&&(s=s.remove(s.find(void 0,void 0,e=>e.id===n.id)),r.delete(n.id))}return{set:s,payloads:r}}},props:{decorations(t){var s;return(null==(s=e.getState(t))?void 0:s.set)??null}}});return e}()]}},eG=class extends er{get name(){return"meta"}onCreate(){if(this.store.setStoreKey("getCommandMeta",this.getCommandMeta.bind(this)),this.options.capture)for(let e of this.store.extensions)this.captureCommands(e),this.captureKeybindings(e)}createPlugin(){return{}}captureCommands(e){let t=e.decoratedCommands??{},s=e.createCommands;for(let r of Object.keys(t)){let n=e[r];e[r]=(...t)=>s=>{var i;let o=n(...t)(s);return s.dispatch&&o&&this.setCommandMeta(s.tr,{type:"command",chain:s.dispatch!==(null==(i=s.view)?void 0:i.dispatch),name:r,extension:e.name,decorated:!0}),o}}s&&(e.createCommands=()=>{let t=s();for(let[r,n]of Object.entries(t))t[r]=(...t)=>s=>{var i;let o=n(...t)(s);return s.dispatch&&o&&this.setCommandMeta(s.tr,{type:"command",chain:s.dispatch!==(null==(i=s.view)?void 0:i.dispatch),name:r,extension:e.name,decorated:!1}),o};return t})}captureKeybindings(e){}getCommandMeta(e){return e.getMeta(this.pluginKey)??[]}setCommandMeta(e,t){let s=this.getCommandMeta(e);e.setMeta(this.pluginKey,[...s,t])}};eG=G([eh({defaultOptions:{capture:O.NZ.isDevelopment},staticKeys:["capture"],defaultPriority:M.xV.Highest})],eG);var ej=class{constructor(e){q(this,r,(0,b.EL)()),q(this,n,void 0),q(this,i,void 0),q(this,o,!0),q(this,a,(0,B.i)()),q(this,l,void 0),q(this,d,void 0),this.getState=()=>this.view.state??this.initialEditorState,this.getPreviousState=()=>this.previousState,this.dispatchTransaction=e=>{var t,s;(0,b.kG)(!this.manager.destroyed,{code:M.mA.MANAGER_PHASE_ERROR,message:"A transaction was dispatched to a manager that has already been destroyed. Please check your set up, or open an issue."}),e=(null==(s=(t=this.props).onDispatchTransaction)?void 0:s.call(t,e,this.getState()))??e;let r=this.getState(),{state:n,transactions:o}=r.applyTransaction(e);X(this,i,r),this.updateState({state:n,tr:e,transactions:o});let a=this.manager.store.getForcedUpdates(e);(0,b.yD)(a)||this.updateViewProps(...a)},this.onChange=(e=(0,b.Ry)())=>{var t,s;let r=this.eventListenerProps(e);$(this,o)&&X(this,o,!1),null==(s=(t=this.props).onChange)||s.call(t,r)},this.onBlur=e=>{var t,s;let r=this.eventListenerProps();null==(s=(t=this.props).onBlur)||s.call(t,r,e),$(this,a).emit("blur",r,e)},this.onFocus=e=>{var t,s;let r=this.eventListenerProps();null==(s=(t=this.props).onFocus)||s.call(t,r,e),$(this,a).emit("focus",r,e)},this.setContent=(e,{triggerChange:t=!1}={})=>{let{doc:s}=this.manager.createState({content:e}),r=this.getState(),{state:n}=this.getState().applyTransaction(r.tr.replaceRangeWith(0,r.doc.nodeSize-2,s));if(t)return this.updateState({state:n,triggerChange:t});this.view.updateState(n)},this.clearContent=({triggerChange:e=!1}={})=>{this.setContent(this.manager.createEmptyDoc(),{triggerChange:e})},this.createStateFromContent=(e,t)=>this.manager.createState({content:e,selection:t}),this.focus=e=>{this.manager.store.commands.focus(e)},this.blur=e=>{this.manager.store.commands.blur(e)};let{getProps:t,initialEditorState:s,element:u}=e;if(X(this,n,t),X(this,d,s),this.manager.attachFramework(this,this.updateListener.bind(this)),this.manager.view)return;let h=this.createView(s,u);this.manager.addView(h)}get addHandler(){return $(this,l)??X(this,l,$(this,a).on.bind($(this,a)))}get updatableViewProps(){return{attributes:()=>this.getAttributes(),editable:()=>this.props.editable??!0}}get firstRender(){return $(this,o)}get props(){return $(this,n).call(this)}get previousState(){return this.previousStateOverride??$(this,i)??this.initialEditorState}get manager(){return this.props.manager}get view(){return this.manager.view}get uid(){return $(this,r)}get initialEditorState(){return $(this,d)}updateListener(e){let{state:t,tr:s}=e;return $(this,a).emit("updated",this.eventListenerProps({state:t,tr:s}))}update(e){let{getProps:t}=e;return X(this,n,t),this}updateViewProps(...e){let t=C(this.updatableViewProps,e);this.view.setProps({...this.view.props,...t})}getAttributes(e){var t;let{attributes:s,autoFocus:r,classNames:n=[],label:i,editable:o}=this.props,a=null==(t=this.manager.store)?void 0:t.attributes,l=(0,b.mf)(s)?s(this.eventListenerProps()):s,d={};(r||(0,b.hj)(r))&&(d=e?{autoFocus:!0}:{autofocus:"true"});let u=(0,b.Nb)(Z(e&&"Prosemirror","remirror-editor",null==a?void 0:a.class,...n).split(" ")).join(" "),h={role:"textbox",...d,"aria-multiline":"true",...o??!0?{}:{"aria-readonly":"true"},"aria-label":i??"",...a,class:u};return(0,b.Yc)({...h,...l})}addFocusListeners(){this.view.dom.addEventListener("blur",this.onBlur),this.view.dom.addEventListener("focus",this.onFocus)}removeFocusListeners(){this.view.dom.removeEventListener("blur",this.onBlur),this.view.dom.removeEventListener("focus",this.onFocus)}destroy(){$(this,a).emit("destroy"),this.view&&this.removeFocusListeners()}eventListenerProps(e=(0,b.Ry)()){let{state:t,tr:s,transactions:r}=e;return{tr:s,transactions:r,internalUpdate:!s,view:this.view,firstRender:$(this,o),state:t??this.getState(),createStateFromContent:this.createStateFromContent,previousState:this.previousState,helpers:this.manager.store.helpers}}get baseOutput(){return{manager:this.manager,...this.manager.store,addHandler:this.addHandler,focus:this.focus,blur:this.blur,uid:$(this,r),view:this.view,getState:this.getState,getPreviousState:this.getPreviousState,getExtension:this.manager.getExtension.bind(this.manager),hasExtension:this.manager.hasExtension.bind(this.manager),clearContent:this.clearContent,setContent:this.setContent}}};r=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,d=new WeakMap;var e$=class{constructor(e,t={}){q(this,u,void 0),q(this,h,(0,b.Ry)()),q(this,c,(0,b.Ry)()),q(this,p,void 0),q(this,m,void 0),q(this,g,M.RC.None),q(this,f,void 0),q(this,y,!0),q(this,v,{create:[],view:[],update:[],destroy:[]}),q(this,S,[]),q(this,x,(0,B.i)()),q(this,k,void 0),q(this,E,void 0),this.getState=()=>{var e;return $(this,g)>=M.RC.EditorView?this.view.state:((0,b.kG)($(this,k),{code:M.mA.MANAGER_PHASE_ERROR,message:"`getState` can only be called after the `Framework` or the `EditorView` has been added to the manager`. Check your plugins to make sure that the decorations callback uses the state argument."}),null==(e=$(this,k))?void 0:e.initialEditorState)},this.updateState=e=>{let t=this.getState();this.view.updateState(e),this.onStateUpdate({previousState:t,state:e})};let{extensions:s,extensionMap:r}=function(e,t){let s=[],r=new WeakMap,n=new WeakMap,i=[],o={duplicateMap:n,parentExtensions:[],gatheredExtensions:i,settings:t};for(let a of e)!function e(t,s){var r;let{gatheredExtensions:n,duplicateMap:i,parentExtensions:o,settings:a}=t,{extension:l,parentExtension:d}=s,{names:u=[]}=s;(0,b.kG)(ea(l),{code:M.mA.INVALID_MANAGER_EXTENSION,message:`An invalid extension: ${l} was provided to the [[\`RemirrorManager\`]].`});let h=l.extensions;if(l.setPriority(null==(r=a.priority)?void 0:r[l.name]),n.push(l),function(e){let{duplicateMap:t,extension:s,parentExtension:r}=e,n=s.constructor,i=t.get(n),o=r?[r]:[];t.set(n,i?[...i,...o]:o)}({duplicateMap:i,extension:l,parentExtension:d}),0!==h.length){if(u.includes(l.name)){(0,F.Z)(!1,`Circular dependency encountered when loading extensions: ${u.join(" > ")} > ${l.name}`);return}for(let c of(u=[...u,l.name],o.push(l),h))e(t,{names:u,extension:c,parentExtension:l})}}(o,{extension:a});i=(0,b.DY)(i,(e,t)=>t.priority-e.priority);let l=new WeakSet,d=new Set;for(let u of i){let h=u.constructor,c=u.name,p=n.get(h);(0,b.kG)(p,{message:`No entries were found for the ExtensionConstructor ${u.name}`,code:M.mA.INTERNAL}),l.has(h)||d.has(c)||(l.add(h),d.add(c),s.push(u),r.set(h,u),p.forEach(e=>null==e?void 0:e.replaceChildExtension(h,u)))}let m=[];for(let g of s)!function(e){let{extension:t,found:s,missing:r}=e;if(t.requiredExtensions)for(let n of t.requiredExtensions??[])s.has(n)||r.push({Constructor:n,extension:t})}({extension:g,found:l,missing:m});return(0,b.kG)((0,b.yD)(m),{code:M.mA.MISSING_REQUIRED_EXTENSION,message:m.map(({Constructor:e,extension:t})=>`The extension '${t.name}' requires '${e.name} in order to run correctly.`).join("\n")}),{extensions:s,extensionMap:r}}(e,t);for(let n of(X(this,f,t),X(this,p,(0,b.vV)(s)),X(this,m,r),X(this,u,this.createExtensionStore()),X(this,g,M.RC.Create),this.setupLifecycleHandlers(),$(this,v).create)){let i=n();i&&$(this,S).push(i)}}static create(e,t={}){return new e$([...(0,b.r2)(e),...function(e={}){let t={exitMarksOnArrowPress:eP.defaultOptions.exitMarksOnArrowPress,excludeBaseKeymap:eP.defaultOptions.excludeBaseKeymap,selectParentNodeOnEscape:eP.defaultOptions.selectParentNodeOnEscape,undoInputRuleOnBackspace:eP.defaultOptions.undoInputRuleOnBackspace,persistentSelectionClass:ek.defaultOptions.persistentSelectionClass};e={...t,...e};let s=C(e,["excludeBaseKeymap","selectParentNodeOnEscape","undoInputRuleOnBackspace"]),r=C(e,["persistentSelectionClass"]);return[new eF,new eI,new ec,new eD,new eA,new eK,new e_,new eB,new ev,new eO,new eP(s),new ew,new eW,new ek(r)]}(t.builtin)],t)}get[M.By](){return M.lk.Manager}get destroyed(){return $(this,g)===M.RC.Destroy}get mounted(){return $(this,g)>=M.RC.EditorView&&$(this,g)<M.RC.Destroy}get output(){var e;return null==(e=$(this,k))?void 0:e.frameworkOutput}get frameworkAttached(){return!!$(this,k)}get extensions(){return $(this,p)}get stringHandlers(){return $(this,h)}get store(){return(0,b.vV)($(this,c))}get extensionStore(){return(0,b.vV)($(this,u))}get tr(){return this.getExtension(ev).transaction}get nodes(){return $(this,c).nodes}get marks(){return $(this,c).marks}get schema(){return $(this,c).schema}get extensionTags(){return $(this,c).tags}get view(){return $(this,c).view}get settings(){return $(this,f)}get document(){return $(this,f).document??(0,O.Me)()}setupLifecycleHandlers(){let e=$(this,u),t=$(this,v),s=[],r=[],n=[];for(let i of(e.nodeNames=s,e.markNames=r,e.plainNames=n,$(this,p)))!function(e){var t,s,r,n;let{extension:i,nodeNames:o,markNames:a,plainNames:l,store:d,handlers:u}=e;i.setStore(d);let h=null==(t=i.onCreate)?void 0:t.bind(i),c=null==(s=i.onView)?void 0:s.bind(i),p=null==(r=i.onStateUpdate)?void 0:r.bind(i),m=null==(n=i.onDestroy)?void 0:n.bind(i);h&&u.create.push(h),c&&u.view.push(c),p&&u.update.push(p),m&&u.destroy.push(m),eu(i)&&a.push(i.name),ed(i)&&"doc"!==i.name&&o.push(i.name),el(i)&&l.push(i.name)}({extension:i,nodeNames:s,markNames:r,plainNames:n,handlers:t,store:e})}setStringHandler(e,t){$(this,h)[e]=t}setStoreKey(e,t){$(this,c)[e]=t}getStoreKey(e){let t=$(this,c)[e];return(0,b.kG)(!(0,b.le)(t),{code:M.mA.MANAGER_PHASE_ERROR,message:"`getStoreKey` should not be called before the values are available."}),t}setExtensionStore(e,t){(0,b.kG)($(this,g)<=M.RC.EditorView,{code:M.mA.MANAGER_PHASE_ERROR,message:"`setExtensionStore` should only be called during the `onCreate` lifecycle hook. Make sure to only call it within the returned methods."}),$(this,u)[e]=t}createExtensionStore(){let e,t;let s=(0,b.Ry)();return Object.defineProperties(s,{extensions:{get:()=>$(this,p),enumerable:!0},phase:{get:()=>$(this,g),enumerable:!0},view:{get:()=>this.view,enumerable:!0},managerSettings:{get:()=>(0,b.vV)($(this,f)),enumerable:!0},getState:{value:this.getState,enumerable:!0},updateState:{value:this.updateState,enumerable:!0},isMounted:{value:()=>this.mounted,enumerable:!0},getExtension:{value:this.getExtension.bind(this),enumerable:!0},manager:{get:()=>this,enumerable:!0},document:{get:()=>this.document,enumerable:!0},stringHandlers:{get:()=>$(this,h),enumerable:!0},currentState:{get:()=>e??(e=this.getState()),set(t){e=t},enumerable:!0},previousState:{get:()=>t,set(e){t=e},enumerable:!0}}),s.getStoreKey=this.getStoreKey.bind(this),s.setStoreKey=this.setStoreKey.bind(this),s.setExtensionStore=this.setExtensionStore.bind(this),s.setStringHandler=this.setStringHandler.bind(this),s}addView(e){if($(this,g)>=M.RC.EditorView)return this;for(let t of(X(this,y,!0),X(this,g,M.RC.EditorView),$(this,c).view=e,$(this,v).view)){let s=t(e);s&&$(this,S).push(s)}return this}attachFramework(e,t){var s;$(this,k)!==e&&($(this,k)&&($(this,k).destroy(),null==(s=$(this,E))||s.call(this)),X(this,k,e),X(this,E,this.addHandler("stateUpdate",t)))}createEmptyDoc(){var e;let t=null==(e=this.schema.nodes.doc)?void 0:e.createAndFill();return(0,b.kG)(t,{code:M.mA.INVALID_CONTENT,message:"An empty node could not be created due to an invalid schema."}),t}createState(e={}){let{onError:t,defaultSelection:s="end"}=this.settings,{content:r=this.createEmptyDoc(),selection:n=s,stringHandler:i=this.settings.stringHandler}=e,{schema:o,plugins:a}=this.store,l=(0,O.EP)({stringHandler:(0,b.HD)(i)?this.stringHandlers[i]:i,document:this.document,content:r,onError:t,schema:o,selection:n});return N.yy.create({schema:o,doc:l,plugins:a,selection:(0,O.b0)(n,l)})}addHandler(e,t){return $(this,x).on(e,t)}onStateUpdate(e){let t=$(this,y);$(this,u).currentState=e.state,$(this,u).previousState=e.previousState,t&&(X(this,g,M.RC.Runtime),X(this,y,!1));let s={...e,firstUpdate:t};for(let r of $(this,v).update)r(s);$(this,x).emit("stateUpdate",s)}getExtension(e){let t=$(this,m).get(e);return(0,b.kG)(t,{code:M.mA.INVALID_MANAGER_EXTENSION,message:`'${e.name}' doesn't exist within this manager. Make sure it is properly added before attempting to use it.`}),t}hasExtension(e){let t=$(this,m).get(e);return!!t}clone(){let e=$(this,p).map(e=>e.clone(e.options)),t=e$.create(()=>e,$(this,f));return $(this,x).emit("clone",t),t}recreate(e=[],t={}){let s=$(this,p).map(e=>e.clone(e.initialOptions)),r=e$.create(()=>[...s,...e],t);return $(this,x).emit("recreate",r),r}destroy(){var e,t,s,r,n,i;for(let o of(X(this,g,M.RC.Destroy),(null==(e=this.view)?void 0:e.state.plugins)??[]))null==(s=null==(t=o.getState(this.view.state))?void 0:t.destroy)||s.call(t);for(let a of(null==(r=$(this,k))||r.destroy(),null==(n=$(this,E))||n.call(this),$(this,S)))a();for(let l of $(this,v).destroy)l();null==(i=this.view)||i.destroy(),$(this,x).emit("destroy")}includes(e){let t=[],s=[];for(let r of $(this,p))t.push(r.name,r.constructorName),s.push(r.constructor);return e.every(e=>(0,b.HD)(e)?(0,b.q9)(t,e):(0,b.q9)(s,e))}},eq=e$;function eX(e,t){return!!((0,O.gf)(e)&&(0,O.pI)(e,M.lk.Manager))&&(!t||e.includes(t))}u=new WeakMap,h=new WeakMap,c=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,f=new WeakMap,y=new WeakMap,v=new WeakMap,S=new WeakMap,x=new WeakMap,k=new WeakMap,E=new WeakMap}}]);